<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Supersearcher Injector</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 1em;
  }
  input[type="text"] {
    width: 60%;
    border-radius: 4px;
    padding: 6px;
    font-size: 1em;
  }
  button {
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 1em;
    margin-left: 8px;
    cursor: pointer;
  }
</style>
</head>
<body>
<h2>Supersearcher Injector</h2>
<label for="urlInput">Enter URL to load:</label>
<br/>
<input id="urlInput" type="text" value="https://sugarylettuce49.github.io/SuperSearcher/wow.html" />
<button id="injectBtn">Inject</button>

<script>
  function injectSupersearcher(url) {
    const newWindow = window.open('about:blank');

    // Sanitize URL to avoid injection attacks (basic)
    if (!url.startsWith('http://') && !url.startsWith('https://')) {
      alert('Please enter a valid http:// or https:// URL');
      newWindow.close();
      return;
    }

    const injectedHTML = `
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Supersearcher Local</title>
<style>
  html, body, #page {
    margin: 0; padding: 0; height: 100%; width: 100%;
    background: #fff;
    font-family: Arial, sans-serif;
  }
  #page {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
  }
  object#frame {
    width: 95vw; 
    height: 90vh; 
    border: none; 
    padding: 1px; 
    border-radius: 8px;
  }
  button, input[type="text"] {
    border-radius: 4px;
    margin: 4px;
    padding: 6px 10px;
    font-size: 1em;
  }
  input[type="text"] {
    width: 50vw;
  }
  #controls {
    margin-top: 8px;
  }
</style>
<script>
  function setSrc(newSrc) {
    document.getElementById('frame').data = newSrc;
  }
  function toolsMenu() {
    var option = prompt("Select an option\\n1: Show info\\n2: Use local wow page");
    if (option === "1") {
      alert("Version info: Super Searcher 2.5\\nBundled WOW version: 2.5\\nBy default, the wow page comes from an online source which is dynamically updated.");
    } else if (option === "2") {
      setSrc('assets/wow.html');
    } else {
      alert("Invalid option");
    }
  }
  function fllscrn() {
    const page = document.getElementById('page');
    if (page.requestFullscreen) {
      page.requestFullscreen();
    } else if (page.webkitRequestFullscreen) { /* Safari */
      page.webkitRequestFullscreen();
    } else if (page.msRequestFullscreen) { /* IE11 */
      page.msRequestFullscreen();
    }
  }
  window.onload = () => {
    document.getElementById('searchfield').value = '${url.replace(/'/g,"\\'")}';
  };
</script>
</head>
<body>
<div id="page">
  <object id="frame" type="text/html" data="${url}" allowfullscreen></object>
  <div id="controls">
    <button onclick="setSrc('https://sugarylettuce49.github.io/SuperSearcher/wow.html')">Home</button>
    <button onclick="toolsMenu()">Tools</button>
    <input id="searchfield" type="text" value="${url}" />
    <button onclick="setSrc(document.getElementById('searchfield').value)">Go</button>
    <button onclick="fllscrn()">Fullscreen Webpage</button>
  </div>
</div>
</body>
</html>
    `;

    newWindow.document.write(injectedHTML);
    newWindow.document.close();
  }

  document.getElementById('injectBtn').addEventListener('click', () => {
    const url = document.getElementById('urlInput').value.trim();
    injectSupersearcher(url);
  });
</script>
</body>
</html>
